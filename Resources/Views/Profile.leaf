<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Your Profile</title>
		<script type="module">
			import { initializeFirebase } from "./js/firebase.js"
			import { verifyAndGetUser, signout } from "./js/user.js"

			const [_, auth] = initializeFirebase("#(apiKey)", "#(authDomain)", "#(projectId)", "#(storageBucket)", "#(messageSenderId)", "#(appId)");
			const user = verifyAndGetUser(auth).then((result) => {
				result.json().then((user) => {
					if(user.listings === undefined || user.listings.length == 0) {
						console.log("No listings with user.");
					}
					document.getElementById("welcome").innerHTML = `<h3>Hello, ${user.fullName}</h3>`;
				});
			}).catch((error) => {
				if(error == "NOUSER") {
					window.location.assign(`${window.location.origin}/authentication`);
				}
				console.error(error);
			});

			const button = document.getElementById("signout");
			button.addEventListener("click", () => {
				signout(auth);
			});
		</script>
    </head>

    <body>
		<div id="welcome"></div>
		<button id="signout">Signout</button>
    </body>
</html>
